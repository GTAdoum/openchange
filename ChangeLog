2006-05-02	Jelmer Vernooij <jelmer@samba.org>

	* ChangeLog: Simplify build system code a bit.

2006-05-01    Julien Kerihuel <j.kerihuel@openchange.org>

	* ChangeLog: Evolution plugin option enabled

2006-03-21	Jelmer Vernooij <jelmer@samba.org>

	* ChangeLog: Builds and runs now!

2006-03-17	Jelmer Vernooij <jelmer@samba.org>
	
	* ChangeLog: All files build now. Also worked on improving 
	portability.

2006-03-16	Jelmer Vernooij <jelmer@samba.org>

	* ChangeLog: More work on OpenChange as a plugin. Most files build now.

2006-03-09	Jelmer Vernooij <jelmer@samba.org>

	* ChangeLog: More work on OpenChange as a plugin. 

2006-02-12  Julien Kerihuel  <kerihu_j@zion.whitefocus.org>

	* ChangeLog: nspi API now works with Exchange 2000 on Windows
	SP4. Fix a bug in DNToEph which now uses the good x500
	organization string. nspi_DNToEph IDL changed from a SPropTagArray
	to a DNToEph_key structure.

	mparse.pl changed so each tags now have a _ERROR version.

	x500.c file added. The objective is to have an API allowing us to
	explode and build x500 dn strings.
	
2006-01-06	Jelmer Vernooij <jelmer@samba.org>

	* ChangeLog: More work on OpenChange as a plugin. 

2006-01-03	Jelmer Vernooij <jelmer@samba.org>

	* ChangeLog: More work on OpenChange as a plugin. 

2006-01-01	Jelmer Vernooij <jelmer@samba.org>

	* ChangeLog: Initial migration of OpenChange to being a plugin in Samba 4

2005-12-01  Julien Kerihuel  <j.kerihuel@openchange.org>
	
	* ChangeLog: SPropTagArray parameter added for nspi functions
	sending property tags arrays (NspiQueryRows, NspiGetMatches,
	NspiGetProps). Exisitng SPropTagArray moved into nspi_profile.c
	torture test.

2005-11-29  Julien Kerihuel  <j.kerihuel@openchange.org>

	* ChangeLog: PT_ERROR and PT_MV_UNICODE version of multi-valued
	PT_MV_STRING8 property tags are now generated

	mapicodes_enum.idl is now generated by mparse and defines an enum
	named MAPICODES. This enum replaces the old uint32_t value for
	PT_ERROR in SPropValue switch case.

	MAPISTATUS data type has been removed from TypeList.pm and added
	as an enumeration in the auto-generated file mapicodes_enum.idl.
	MAPI Error codes have been removed from libmapi/include/mapicode.h
	so there are no duplicated data. The auto-generated mapicode.c
	file has been kept and uses ndr_print_MAPISTATUS from
	librpc/gen_ndr/ndr_exchange.c
	
	* ChangeLog: libmapi/include/mapicode.h and libmapi/mapicode.c are
	now auto-generated from mparse.pl at compilation time.

2005-11-28  Julien Kerihuel  <j.kerihuel@openchange.org>

	* ChangeLog: PT_ERROR types for property tags with PT_STRING8 or
	PT_UNICODE type has been added to mapitags.{c,h} and
	mapitags_enum.h.

	- libmapi/config.mk now force to compile if modifications have been
	added to mparse.pl
	
	- libmapi/conf/mapi-codes file has been added to the repository.
	This file is for future use. The objective is to remove
	include/mapicode.h and util/mapicode.c and auto-generate them +
	create an enum for mapi error code and add it into exchange.idl.
	Last but not least this file will help removing MAPISTATUS type
	and replace it with an enum.
	
2005-10-31  Julien Kerihuel  <j.kerihuel@openchange.org>

	* ChangeLog: GetHierarchyInfo now retrieves without any memory
	allocation problem a SRowSet data strucure with all information
	necessary for Outlook.

	I now have to find how are container sorted and replace the
	Recipients DISPLAY_NAME for the top recipients by a NULL string.

2005-10-30  Julien Kerihuel  <j.kerihuel@openchange.org>

	* ChangeLog: WARNING: This build SIGSEGV and is only temporary so
	we can keep the merge with Samab4 up to date. There is memory
	allocation problems with GetHierarchyInfo.

	- source/libmapi/utils.c added. This file contains the
	generate_recipient_entryid function which takes the PR_ENTRYID
	field value, modify it the way Outlook expects it and returns a
	struct SBinary.
	
	- the PR_ENTRYID field for the recipient with PR_DISPLAY_NAME
	value set to NULL is now hardcoded in source/libmapi/utils.c

	- add the recipient objectClass

	- fixed the storedb schema

	- libmapi/storedb/storedb.c filled with several functions which
	access the store.

	- GetHierarchyTable implemented

	- a sample set_PropValue function has been added to
	libmapi/property.c

2005-10-27  Julien Kerihuel  <j.kerihuel@openchange.org>

	* ChangeLog: OpenChange store schema fixed. Removed a superficial
	Root Container and replaced it with the real one. basedn for Root
	Container has been fixed.

	storedb_search_container_tree function added to storedb.c
	
2005-10-26  Julien Kerihuel  <j.kerihuel@openchange.org>

	* ChangeLog: change IsMaster attribute from INTEGER to STRING
	storedb_search_count function added to the storedb subsystem.
	
	* ChangeLog: 
	- member attribute replaces child in the storedb schema.
	- memberOf attribute has been added and refer to the container's
	parent.
	- cn and name attributes overlapped. In order to have a generic
	store, name has been removed and cn will be used instead.
	- IsMaster attribute replaces master one.

	storedb_search_dn function has been added to the storedb.c file.

	a 0xFFFFFFFF containerID value has been assigned to the Root
	container. This is temporary until we figure how to name it
	correctly.

	GetHierarchyInfo has been enhanced with a call to
	storedb_search_dn for testing purpose.
	
	* ChangeLog: szSTORE_URL and lp_store_url() removed in
	param/loadparm.c and replaced with a parametric option
	exchange:store in smb.conf.

	store binary added to test nspi function implementation. It will
	be used at first to test GetHierarchyInfo and storedb
	behavior/results.

2005-10-25  Julien Kerihuel  <j.kerihuel@openchange.org>

	* ChangeLog: libmapi/storedb directory added and STOREDB subsystem
	appended to config.mk. A basic storedb implementation has been
	added with the storedb_connect() fcnt.

	- LIBMAPI_CORE now depends on STOREDB to compile container.c
	(GetHierarchyInfo)

	- OpenChange global parameter szSTORE_URL and lp_store_url()
	function have been added to param/loadparm.c
	
2005-10-24  Julien Kerihuel  <j.kerihuel@openchange.org>

	* ChangeLog: A basic howto has been added in OpenChange/howto.txt
	so developers can easily configure OpenChange server and test it.
	
	* ChangeLog: entryID field added to container ldif file. entryID
	value is an auto-generated GUID.
	
	* ChangeLog: libmapi/setup directory added. Scripts and skeleton
	design have been added. We can create a default openchange
	store with the containers requested in NspiGetHierarchyInfo.

	sudo make installoc: install openchange script in /usr/local/samba/*
	and allow to use openchange provision script.

	libmapi/container.c added: This file contains the prototype of
	GetHierarchyInfo and will access containers objectClass in the
	store.ldb database. This database is set up using openchange setup
	scripts.
	
	* ChangeLog: When samba4 changed the compilation system, a
	conflict was detected for torture/config.mk. While the conflict
	had been resolved, smbtorture refused to compile due to a blank
	list of dependencies generated in Makefile. This commit fix this
	compilation problem. diff with previous version to see the
	"changes".

2005-10-23  Julien Kerihuel  <j.kerihuel@openchange.org>

	* ChangeLog: Fix libmapi build system
	GetHierarchyInfo ulFlags added to mapidefs.h

2005-10-20  Julien Kerihuel  <j.kerihuel@openchange.org>

	* ChangeLog: 
	- PR_SERVICE_INSTALL_ID (0x3d13001e) property tag added to
	mapi-properties
	- PR_CONTAINER_FLAGS added to libmapi/include/mapidefs.h
	
	* ChangeLog: Container flags added to libmapi/include/mapidefs.h
	
	* ChangeLog: mparse.pl now generates UNICODE version of PT_STRING8
	property tags.
	
	* ChangeLog: bugs fixed in locale_codepage
	- Code has been enhanced and now supports the -i option which
	prints information, the user only have to paste into smb.conf to
	have a running configuration. Need to add codepage support for a
	given language.
	- rpc_server/exchange/dcesrv_exchange.c now supports
	NspiBind. GUID is auto-generated.
	
	
2005-10-17  Julien Kerihuel  <j.kerihuel@openchange.org>

	* ChangeLog: fix a var name bug in torture/rpc/emsmdb.c
	
	* ChangeLog: 
	- removed spurious [ref] in exchange.idl and replaced ascstr with
	[string,charset(DOS)] according to the new Jelmer's string
	implementation.
	- OpenChange/smb.conf sample updated
	- RPC-NSPI_PROFILE now specify the server name in nspi_DNToEph
	with --option="exchange:server=SERVER"
	- Sample NSPI server implementation added to
	rpc_server/exchange/dcerpc_exchange.c
	- Temporary bug fix in libndr/ndr/ndr_string.c: CH_DOS strings
	[size] and [length] are pushed on the network as if they were
	non-null terminated string (ascstr_noterm). ndr_charset_length has
	been modified to add the NULL character to the global string
	length.
	
2005-10-12  Julien Kerihuel  <j.kerihuel@openchange.org>

	* ChangeLog: "name" NAME_STRING field replaced by "server_dn" in
	NspiDNToEph

2005-10-11  Julien Kerihuel  <j.kerihuel@openchange.org>

	* ChangeLog: Fixed an unknown property tags in libmapi/nspi.c due
	to the recent libmapi/conf/mapi-properties modifications.

	* ChangeLog: 
	- mparse.pl now generates a MAPITAGS enum for exchange.idl.
	- uint32_t ulPropTag has been replaced with MAPITAGS ulPropTag.
	- ndrdump now displays MAPI property tags and associated values.
	- mapitags.h include has been removed from include/includes.h
	- duplicated tags removed from mapi-properties (BUSINESS tags and
	personal researches)
	
2005-10-10  Julien Kerihuel  <j.kerihuel@openchange.org>

	* ChangeLog: source/libmapi/conf directory added.
	- mapi-properties file from Gnome Evolution added.
	- mparse.pl perl code generator added.
	- source/libmapi/include/mapitags.h and source/libmapi/mapitags.c
	  are now auto-generated from mapi-properties

	* ChangeLog: RPC-NSPI_PROFILE test is now GENERIC. 

	nspi_DNToEph has been modified to be generic: the required string
	uses domain and Exchange netbios name:
	- cli_credentials_get_domain
	--option="exchange:server=SERVERNAME"

	* ChangeLog: The fix Jelmer added has been removed due to ndr_pull
	error in emsmdb_connect.
	
2005-10-07  Julien Kerihuel  <j.kerihuel@openchange.org>

	* ChangeLog: Fix a bug: NspiQueryRows now uses the PR_INSTANCE_KEY
	value returned by NspiGetMatches. instance_key field now replaces
	a previously unknown field in NspiGetMatches [in].

	struct mapi_profile added to nspi_context. This structure profile
	information returned by the Exchange server.
	
	* ChangeLog: get_SPropValue_SRowSet function added to
	source/libmapi/property.c return wanetd SPropValue structure from
	a RowSet structure.
	
	* ChangeLog: NspiGetProps IDL and implementation in libmapi/nspi.c
	is now working with the RPC-NSPI_PROFILE torture test. The first
	RPC-NSPI_PROFILE test is now working.
	
	* ChangeLog: Fixed compilation error in torture/rpc/nspi.c - Bad
	number of arguments for nspi_bind.

	* ChangeLog: NspiDoToEph IDL and implementation in libmapi/nspi.c
	is now working with the RPC-NSPI_PROFILE torture
	test. Auto-generate the string will have to be implemented later
	to make nspi_DnToEph generic.

2005-10-07  Julien Kerihuel  <j.kerihuel@openchange.org>

	* ChangeLog: NspiQueryRows IDL and implementation in
	libmapi/nspi.c is now working with the RPC-NSPI_PROFILE torture
	test.
	
	* ChangeLog: if no exchange:username option is provided then
	NT4 username is used in NspiGetMatches.

	OpenChange/smb.conf sample OpenChange configuration file added.
	
	* ChangeLog: NspiGetMatches IDL and implementation in
	libmapi/nspi.c is now working with the RPC-NSPI_PROFILE torture
	test. The username to check can be set on command-line using the
	following argument:

	--option="exchange:username=value"

	source/libmapi/property.c file added. A function creating a
	variable SPropTag array has been added.

	source/libmapi/include/mapitags.h added. Include property tags
	used in RPC-NSPI_PROFILE test.

	source/libmapi/include/mapidefs.h added. Include restriction types
	defines.
	
2005-10-06  Julien Kerihuel  <j.kerihuel@openchange.org>

	* Changelog: Fix return values for NspiGetHierarchyInfo and
	NspiGetMatches in rpc_server/exchange/dcesrv_exchange.c
	
	* Changelog: nspi_set_MAPI_SETTINGS function added in
	libmapi/nspi.c. MAPI_SETTINGS seems to be used in most of the NSPI
	functions IDL. This functions allocate a MAPI_SETTINGS structure
	and set the default parameters (handle, codepage and locale_id).
	Codepage, Language and Method can be set from command-line using
	the following arguments:

	--option="locale:codepage=value" 
	--option="locale:language=value"
	--option="locale:method=value"

	nspi_set_MAPI_SETTINGS is called from nspi_bind.
	a MAPI_SETTINGS structure has been added in nspi_context.

	All the MAPI_SETTINGS common code has been removed from the
	different nspi calls and replaced by an assignment to
	nspi_context->settings.

	* Changelog: Replace uint8_t padding[16] with a MAPIUID structure
	and named it service_provider.
	
2005-10-05  Julien Kerihuel  <j.kerihuel@openchange.org>

	* Changelog: NspiGetMatches IDL added, works for [in] and [out]

2005-10-04  Julien Kerihuel  <j.kerihuel@openchange.org>

	* Changelog: NspiGetHierarchyInfo IDL works for [in] and
	[out]. Function added to source/libmapi/nspi.c and
	RPC-NSPI_PROFILE torture case.

2005-10-02  Julien Kerihuel  <j.kerihuel@openchange.org>

	* Changelog: RPC-NSPI_PROFILE test skeleton ( NspiBind and
	NspiUnbind) added in smbtorture. The objective is to create a
	torture test able to create a MAPI Profile.
	
	libmapi/nspi.c and libmapi/include/nspi.h added:
	- nspi_bind and nspi_unbind function added
	- nspi_context data structure added

	* Changelog: libmapi/IMAPISession.c removed
	- OpenMsgStore IDL enhanced

	* ChangeLog: Hybrid EcDoRpc implementation:
	- source/libmapi/include/emsmdb.h file added
	- source/libmapi/idl/build.sh added: Compilation of libmapi/idl
	files
	- automatic creation of the libmapi/generated directory
	- source/libmapi/emsmdb.c file added:
		* emsmdb_connect: Connect to an Exchange Server
		* emsmdb_transaction: Marshall a MAPI_REQ struct
		* emsmdb_transaction_unknown: Marshall a uint8_t blob
		* emsmdb_registernotify: Register a session notification
	- MAPI_DATA content marshalling/unmarshalling using a TDR layer.
	- Implementation of the OpenMsgStore request IDL in
	libmapi/idl/IMAPISession.idl
	- emsmdb_context structure used to abstract emsmdb connection
	params.
	- OpenMessageStore RPC-EXCHANGE function written using the new
	EcDoRpc implementation
	- Fixed a bug in TDR.pm and added tdr_print_debug_helper in
	lib/tdr/tdr.c
	
2005-09-27  Julien Kerihuel  <j.kerihuel@openchange.org>

	* Changelog: A critical bug has been identified. There was a
	problem with synchronization/merging between the trunk and the
	local branch. Here is a detailed listing of the changes:

	- source/build/pidl removed
	- MCR layer removed / waiting for Jelmer TDR layer's example.
	- mcr_full and mcr make rules have been removed
	- mapi header files moved from source/include to
	  source/libmapi/include
	- MAPI_STATUS push/pull/print moved from
	  source/librpc/ndr/ndr_basic.c to source/librpc/ndr/ndr_mapi.c
	- opnum FUNCTIONS property removed

	- ndrdump EcDoRpc dump has been tested and is working
	- torture RPC-EXCHANGE test is functionnal.
	
2005-09-25  Julien Kerihuel  <j.kerihuel@openchange.org>

	* Changelog: MCR Header package completed. IMAPISession.idl added
	to libmapi/idl.

	* Changelog: pidl executable fixed. mcr-header now uses
	Pidl::Parse::NDR::Parse to build the pidl tree.

	* Changelog: build/smb_build/makefile.pm now includes a mcr_full:
	and mcr: build rules. The script/build_mcr.sh file has been added
	to automatically generate the mcr .h and .c files.

	* Changelog: --mcr-header and --mcr-parse options have been added
	to pidl. The opnum keyword for FUNCTIONS has been added to
	Validator.pm. This way we can generate the mapi opnum in the
	libmapi/gen_mcr/mcr_$basename.h files.

	* Changelog: Implementation of a second push/pull layer for MAPI
	content marshalling/unmarshalling. A skeleton implementation of
	MCR (MAPI Content Representation) has been added in
	source/build/pidl/Parse/Pidl/OpenChange/MCR. Yet only a basic
	Header.pm package has been developed. It generates defines for the
	interfaces.

2005-09-22  Julien Kerihuel  <j.kerihuel@openchange.org>

	* Changelog: We consider the first 2 bytes of MAPI content define
	the mapi opnum (operation number). The MAPI_DATA structure now
	includes an uint16_t opnum field. The ndr push/pull for MAPI_DATA
	and the RPC-EXCHANGE torture case have been modified to reflect
	this change.

	* Changelog: the MAPI_DATA ndr_print function has been improved.
	It now prints the MAPI opnum and its corresponding name when
	available, otherwise "Unknown opnum" is displayed.
	
2005-09-19  Julien Kerihuel  <j.kerihuel@openchange.org>

	* Changelog: MAPI content length is now set in the user
	context. It means that the content is for the user the blob of
	data it receives without the length field. The length field is
	automatically added in the push_MAPI_DATA ndr function.  

	Comments have been added to source code in order to remind
	operation tricks.
	
	* Changelog: The RPC-EXCHANGE torture case has been cleaned and
	compiles without warnings.

2005-09-18  Julien Kerihuel  <j.kerihuel@openchange.org>

	* Changelog: Implementation of OpenInbox() started. Problems
	encountered while trying to find how the remaining byte of the
	first request is filled.
	
	* Changelog: OpenIPMSubtree() is now implemented in the
	RPC-EXCHANGE torture case. The remaining byte algorithm has been
	enhanced.
	
2005-09-17  Julien Kerihuel  <j.kerihuel@openchange.org>

	* Changelog: OpenRootFolder() is now implemented in the 
	RPC-EXCHANGE torture case. I've added an alpha version of the
	algorithm dedicated to automatically fill the remaining bytes.

